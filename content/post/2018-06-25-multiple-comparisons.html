---
title: "Multiple Comparisons"
author: "Jaromil Frossard"
date: '2018-06-25'
categories: []
slug: multiple-comparisons
summary: A brief summary of multiple comparisons methods (in progress)
tags: []
bibliography: post.bib
---



<div id="notation-in-progress" class="section level1">
<h1>Notation (in progress)</h1>
<p>The multiple comparisons framework assume <span class="math inline">\(m\)</span> tests which are split into the follwing table <span class="citation">(Benjamini and Hochberg 1995)</span>:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Significant test</th>
<th>Non-significant test</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>True <span class="math inline">\(H_0\)</span></td>
<td><span class="math inline">\(U\)</span></td>
<td><span class="math inline">\(V\)</span></td>
<td><span class="math inline">\(m_0\)</span></td>
</tr>
<tr class="even">
<td>FALSE <span class="math inline">\(H_0\)</span></td>
<td><span class="math inline">\(T\)</span></td>
<td><span class="math inline">\(S\)</span></td>
<td><span class="math inline">\(m-m_0 = m_1\)</span></td>
</tr>
<tr class="odd">
<td></td>
<td><span class="math inline">\(m - R\)</span></td>
<td><span class="math inline">\(R\)</span></td>
<td><span class="math inline">\(m\)</span></td>
</tr>
</tbody>
</table>
<p>In that setting, we assume:</p>
<ul>
<li><span class="math inline">\(m\)</span>: <strong>fix</strong> and <strong>known</strong></li>
<li><span class="math inline">\(m_0\)</span> and <span class="math inline">\(m_1\)</span>: <strong>fix</strong> but <strong>unknown</strong></li>
<li><span class="math inline">\(R\)</span> is an <strong>observed</strong> random variable</li>
<li><span class="math inline">\(U\)</span>, <span class="math inline">\(V\)</span>, <span class="math inline">\(T\)</span>, <span class="math inline">\(S\)</span> are <strong>unobserved</strong> random variable.</li>
<li><span class="math inline">\(V\)</span> is the number of <strong>type I error</strong> and <span class="math inline">\(S\)</span> is the total of <strong>type II error</strong>.</li>
<li><span class="math inline">\(E(U/m_0)=\alpha\)</span> if the tests are exacts, for a individual type I error probability <span class="math inline">\(\alpha\)</span>.</li>
</ul>
</div>
<div id="error-of-interest" class="section level1">
<h1>Error of interest</h1>
<p>Given the previous table, we define different type of error.</p>
<div id="family-wise-error-rate-fwer" class="section level5">
<h5>Family-wise error rate (FWER)</h5>
<p>Probability of making at leaste one type I error: <span class="math inline">\(FWER = Pr(V&gt;0) = q\)</span>.</p>
<p><strong>Variation</strong>:</p>
<ul>
<li>generalized FWER: <span class="math inline">\(u-FWER = Pr(V &gt; u)\)</span>.</li>
</ul>
<p><strong>False discovery rate (FDR)</strong>: Proportion of error amoung all significant tests: <span class="math inline">\(FDR = E(Q)\)</span> where <span class="math inline">\(Q = V/R\)</span> and <span class="math inline">\(FDR = 0\)</span> when <span class="math inline">\(R=0\)</span>.</p>
</div>
</div>
<div id="procedure-to-control-fwer." class="section level1">
<h1>Procedure to control FWER.</h1>
<p>Given the null hypothesis <span class="math inline">\(H_1, \dots, H_m\)</span> , with their corresponding <span class="math inline">\(p\)</span>-value <span class="math inline">\(p_1, \dots, p_m\)</span>, we want to control at a level <span class="math inline">\(q\)</span> the FWER such that <span class="math inline">\(Pr(V &gt; 0) =Pr(\bigcup\limits_{i=1}^{m_0} p^0_{i}&lt;\alpha^\star) \leq q\)</span> where <span class="math inline">\(p^0_i\)</span> correspond to the <span class="math inline">\(m_0\)</span> hypothesis under the true null.</p>
<div id="bonferoni" class="section level2">
<h2><a href="https://en.wikipedia.org/wiki/Bonferroni_correction">Bonferoni</a></h2>
<p><strong>Procedure:</strong>
Use <span class="math inline">\(\alpha^\star_i = q/m\)</span> for all <span class="math inline">\(i\)</span> as individual level.</p>
<p><strong>Proof</strong>:
<span class="math display">\[FWER =  Pr\left( \bigcup\limits_{i=1}^{m_0} (p^0_{i}&lt;\alpha^\star )\right) \leq \sum_{i=1}^{m_0}Pr \left(p^0_i &lt; \alpha^\star \right) = m_0 \alpha^\star \leq  m \alpha^\star ~ \Rightarrow ~\alpha^\star =q/m \Leftrightarrow FWER \leq q \]</span></p>
</div>
<div id="holm" class="section level2">
<h2><a href="https://en.wikipedia.org/wiki/Holm-Bonferroni_method">Holm</a></h2>
<p><strong>Procedure:</strong>
Sort the <span class="math inline">\(p\)</span>-values, <span class="math inline">\(p_{(1)}&lt; \dots&lt; p_{(m)}\)</span> with there corresponding hypothesis <span class="math inline">\(H_{(1)}, \dots&lt; H_{(m)}\)</span>. Reject all <span class="math inline">\(k\)</span> hypothesis <span class="math inline">\(H_{(1)}, \dots&lt; H_{(k)}\)</span>, such that <span class="math inline">\(p_{(k+1)} \geq \alpha^\star_{(k+1)} = q/(m - k)\)</span> and <span class="math inline">\(p_{(i)} \leq \alpha^\star_{(i)} = q/(m+1 -i)\)</span> for all <span class="math inline">\((i)\)</span> as individual level.</p>
<p><strong>Rationale:</strong>
After sorting the <span class="math inline">\(p\)</span>-values, use the Bonferoni correction for the first hypothesis. If your reject <span class="math inline">\(H_{(1)}\)</span>: <strong>1.</strong> either we made a correct decision, <span class="math inline">\(H_{(1)}\)</span> is a false hypothesis (<span class="math inline">\(H_{(1)} \in H^1_1,\dots, H^1_{m_1}\)</span> and <span class="math inline">\(V=0\)</span>), and we can use the Bonferoni for the <span class="math inline">\(m-1\)</span> next hypothesis, <strong>2.</strong> either <span class="math inline">\(H_{(1)}\)</span> is a true hypothesis (<span class="math inline">\(H_{(1)} \in H^0_1,\dots, H^0_{m_0}\)</span> and <span class="math inline">\(V=1\)</span>), and our next decisions will not change the <span class="math inline">\(FWER=Pr(V&gt;0)\)</span> given <span class="math inline">\(V=1\)</span>.</p>
<p><strong>Proof:</strong>
After <span class="math inline">\(k-1\)</span> correctely reject hypothesis, we need to proof that the <span class="math inline">\(k\)</span>th hypothesis is reject at a level <span class="math inline">\(q\leq FWER\)</span>, then:</p>
<p><span class="math display">\[FWER =  Pr\left(\bigcup\limits_{i=k}^{m_0} (p^0_{i}&lt;\alpha^\star_{(k)} )\right) \leq (m_0-k+1) \alpha^\star_{(k)} \leq (m-k+1) \alpha^\star_{(k)}  ~\Rightarrow ~ \alpha^\star_{(k)}  = q/(m-k+1) \Leftrightarrow FWER \leq q \]</span></p>
</div>
<div id="closure-principle" class="section level2">
<h2>Closure principle</h2>
<p><strong>Procedure:</strong>
Reject <span class="math inline">\(H_i\)</span> at a <span class="math inline">\(q\)</span> level if all <span class="math inline">\(p\)</span>-value <span class="math inline">\(p^\ast_{1},\dots,p^\ast_P\)</span> corresponding to the hypothesis of all intersections <span class="math inline">\(H^\ast_P = \bigcap\limits_{i \in C} H_i\)</span> all <span class="math inline">\(P\)</span> subset <span class="math inline">\(C\)</span> of <span class="math inline">\(1,\dots,m\)</span> are reject at a <span class="math inline">\(q\)</span> level <span class="citation">(<span class="citeproc-not-found" data-reference-id="hochberg_multiple_1987"><strong>???</strong></span>)</span>.</p>
<p><strong>Rationale:</strong>
<!-- The probabilty of rejecting $H_i$ when it is false is split into all possibility: only $H_i$ is false, $H_i \cap H_1$ is false,  $H_i \cap H_2$ is false, $H_i \cap H_1 \cap H_2$ is false,.., $H_1\cap \dots \cap H_m$ is false. --></p>
<p><strong>Proof:</strong></p>
<!-- $$FWER =   -->
<!-- Pr\left(\bigcup\limits_{i=1}^{m_0} (p^0_{i}< q) \right) =  -->
<!-- Pr\left(\bigcup\limits_{i=1}^{m_0} (p_{i}^0< q)\bigcap \bigcap \limits_{i=1}^{P} (p^*_{i}<q )\right)=  -->
<!-- Pr\left(\bigcap\limits_{i=1}^{P} (p^*_{i}<q) \right) Pr\left(\bigcup\limits_{i=1}^{m_0} (p_{i}^0< q) \Biggr\rvert \bigcap \limits_{i=1}^{P} (p^*_{i}<q )\right)$$ -->
</div>
</div>
<div id="bibliography" class="section level1 unnumbered">
<h1>Bibliography</h1>
<div id="refs" class="references">
<div id="ref-benjamini_controlling_1995">
<p>Benjamini, Yoav, and Yosef Hochberg. 1995. “Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, 289–300. <a href="http://www.jstor.org/stable/2346101" class="uri">http://www.jstor.org/stable/2346101</a>.</p>
</div>
</div>
</div>
